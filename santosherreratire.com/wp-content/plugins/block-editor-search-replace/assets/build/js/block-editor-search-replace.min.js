var BESR=BESR||{},$=jQuery||{};jQuery;BESR=BESR||{},$=jQuery||{};jQuery,function(e){var t=e.element.createElement,s=e.element.Fragment,r=e.editPost.PluginDocumentSettingPanel,a=e.plugins.registerPlugin,n=e.data.select("core/editor");a("block-editor-search-replace-controls",{icon:"",render:function(){return t(s,{},t(r,{name:"block-editor-search-replace-sidebar",title:"Search & Replace",className:"besr-block-editor-ui"},t("div",{dangerouslySetInnerHTML:{__html:'<div class="besr"><div class="besr-block-editor-ui"><p>Block Editor search and replace will help you to find any text inside the Block Editor content area and replace with another one.</p><form name="besr-block-editor" id="besr-block-editor" type="post"><input type="hidden" name="besr-current-post-type" id="besr-current-post-type" value="'+n.getCurrentPostType()+'"><input type="hidden" name="besr-current-post-id" id="besr-current-post-id" value="'+n.getCurrentPostId()+'"><input type="hidden" name="besr-classic-editor" id="besr-classic-editor" value="0"><div class="search-replace-group"><p><input type="text" name="besr-search" id="besr-search" class="components-text-control__input besr-search" value="" placeholder="Enter you search phrase..." /></p><p><input type="text" name="besr-replace-with" id="besr-replace-with" class="components-text-control__input besr-replace-with" value="" placeholder="Enter your replace with phrase..." /></p><p><label for="besr-highlight-search"><input type="checkbox" name="besr-highlight-search" id="besr-highlight-search" checked /> <span>Highlight text on search</span></label></p><p><label for="besr-case-sensitive"><input type="checkbox" name="besr-case-sensitive" id="besr-case-sensitive" checked /> <span>Case sensitive search & replace</span></label></p><p class="button-group"><button name="besr-search-replace" class="components-button is-primary besr-search-replace"><i class="dashicons dashicons-randomize"></i>Replace</button><button name="besr-clean-tags" class="components-button is-primary besr-clean-tags"><i class="dashicons dashicons-trash"></i>Reset</button></p><div class="besr-search-replace-output d-none"></div></div></form></div></div>'}})))}})}(window.wp);BESR=BESR||{},$=jQuery||{};BESR.highlightSearchText=function(e){e.preventDefault(),e.stopPropagation();$(e.target);var t=$(e.target).closest("form");$(".besr-search-replace-output").addClass("d-none").removeClass("d-block"),$.ajax({method:"post",url:besr.ajax_url,data:{action:"highlight_search",search_input_text:t.find('input[name="besr-search"]').val(),current_post_id:t.find('input[name="besr-current-post-id"]').val(),is_highlighted:t.find('input[name="besr-highlight-search"]:checked').length,is_case_sensitive:t.find('input[name="besr-case-sensitive"]:checked').length,is_classic_editor:t.find('input[name="besr-classic-editor"]').val()},beforeSend:function(){},success:function(e,s,r){var a=JSON.parse(e);""!==a[0].message&&(BESR.reloadBlockEditor(t,t.find('input[name="besr-classic-editor"]').val()),$(".besr-search-replace-output").removeClass("d-none").addClass("d-block"),$(".besr-search-replace-output").empty().html(a[0].message))}})},BESR.runSearchReplace=function(e){e.preventDefault();$(e.target);var t=$(e.target).closest("form");$.ajax({method:"post",url:besr.ajax_url,data:{action:"search_and_replace",search_input_text:t.find('input[name="besr-search"]').val(),replace_input_text:t.find('input[name="besr-replace-with"]').val(),current_post_id:t.find('input[name="besr-current-post-id"]').val(),is_case_sensitive:t.find('input[name="besr-case-sensitive"]:checked').length,is_classic_editor:t.find('input[name="besr-classic-editor"]').val()},beforeSend:function(){},success:function(e,s,r){var a=JSON.parse(e);""!==a[0].message&&(BESR.reloadBlockEditor(t,t.find('input[name="besr-classic-editor"]').val()),$(".besr-search-replace-output").removeClass("d-none").addClass("d-block"),$(".besr-search-replace-output").empty().html(a[0].message))}})},BESR.removeAllHighlights=function(e){e.preventDefault();$(e.target);var t=$(e.target).closest("form");$.ajax({method:"post",url:besr.ajax_url,data:{action:"clean_besr_tags",current_post_id:t.find('input[name="besr-current-post-id"]').val(),is_classic_editor:t.find('input[name="besr-classic-editor"]').val()},beforeSend:function(){},success:function(e,s,r){var a=JSON.parse(e);""!==a[0].message&&(BESR.reloadBlockEditor(t,t.find('input[name="besr-classic-editor"]').val()),$(".besr-search-replace-output").removeClass("d-none").addClass("d-block"),$(".besr-search-replace-output").empty().html(a[0].message))}})},BESR.reloadBlockEditor=function(e,t){var s;s=window.wp,$.ajax({method:"post",url:besr.ajax_url,data:{action:"update_block_editor_content",current_post_id:e.find('input[name="besr-current-post-id"]').val()},beforeSend:function(){},success:function(e,r,a){var n=JSON.parse(e);"1"==t?($("#content_ifr").contents().find("head").append($("<style/>").html("besr-highlight { background-color: #ff8; padding: 3px;}")),$("#content_ifr").contents().find("body").empty().html(n)):s.data.dispatch("core/block-editor").resetBlocks(s.blocks.parse(n))}})},function(e,t){e(document).on("blur",'input[name="besr-search"]',BESR.highlightSearchText),e(document).on("click",'button[name="besr-search-replace"]',BESR.runSearchReplace),e(document).on("click",'button[name="besr-clean-tags"]',BESR.removeAllHighlights)}(jQuery);